<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>ChatGPT is fairly good at coreference resolution and coding assignments • Yury Kashnitsky</title>
    <meta name="description" content="​
Here I’m trying to discover ChatGPT’s weaknesses and test its ability to resolve coreferences in natural text and crack mlcourse.ai assignments. Naturally, I could not resist playing with the new OpanAI chatbot chatGPT with the goal of spotting some of its weaknesses. Quite a few have already been pointed out, e.g. Sergey Ivanov even measured chatGPT’s IQ.
">
    <meta name="keywords" content="">
    
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="ChatGPT is fairly good at coreference resolution and coding assignments">
	<meta name="twitter:description" content="​
Here I’m trying to discover ChatGPT’s weaknesses and test its ability to resolve coreferences in natural text and crack mlcourse.ai assignments. Naturally, I could not resist playing with the new OpanAI chatbot chatGPT with the goal of spotting some of its weaknesses. Quite a few have already been pointed out, e.g. Sergey Ivanov even measured chatGPT’s IQ.
">
	<meta name="twitter:site" content="@ykashnitsky">
	<meta name="twitter:creator" content="@ykashnitsky">
	
	<meta name="twitter:card" content="summary">
	<meta name="twitter:image" content="http://localhost:4000/images/logo-120x120.png">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en">
	<meta property="og:type" content="article">
	<meta property="og:title" content="ChatGPT is fairly good at coreference resolution and coding assignments">
	<meta property="og:description" content="​
Here I’m trying to discover ChatGPT’s weaknesses and test its ability to resolve coreferences in natural text and crack mlcourse.ai assignments. Naturally, I could not resist playing with the new OpanAI chatbot chatGPT with the goal of spotting some of its weaknesses. Quite a few have already been pointed out, e.g. Sergey Ivanov even measured chatGPT’s IQ.
">
	<meta property="og:url" content="http://localhost:4000/2022/chatgpt3-coref-resolution/">
	<meta property="og:site_name" content="Yury Kashnitsky">

    <link rel="canonical" href="http://localhost:4000/2022/chatgpt3-coref-resolution/">

    <link href="http://localhost:4000/atom.xml" type="application/atom+xml" rel="alternate" title="Yury Kashnitsky Atom Feed">
    <link href="http://localhost:4000/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" href="http://localhost:4000/css/main.css">


    

  </head>

  <body id="js-body">
    <!--[if lt IE 9]><div class="upgrade notice-warning"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

    <header id="masthead">
  <div class="inner-wrap">
    <a href="http://localhost:4000/" class="site-title">Yury Kashnitsky</a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">Yury Kashnitsky</a></li>
	
    
    <li><a href="http://localhost:4000/" >Blog</a></li>
  
    
    <li><a href="http://localhost:4000/projects" >Projects</a></li>
  
    
    <li><a href="http://localhost:4000/cv" >CV</a></li>
  
    
    <li><a href="http://localhost:4000/about" >About</a></li>
  
    
    <li><a href="http://localhost:4000/contacts" >Contacts</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
  

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</header><!-- /.masthead -->

    <nav role="navigation" id="js-menu" class="sliding-menu-content">
  <h5>Yury Kashnitsky <span>Table of Contents</span></h5>
  <ul class="menu-item">
    <li>
      <a href="http://localhost:4000/">
        <img src="http://localhost:4000/images/navigation/thumbnail-blog.png" alt="teaser" class="teaser">
        <div class="title">Blog</div>
        <p class="excerpt">Yorko's view on machine learning, popular science, career development, programming, soft skills, etc.</p>
      </a>
    </li><li>
      <a href="http://localhost:4000/projects">
        <img src="http://localhost:4000/images/navigation/thumbnail-projects.png" alt="teaser" class="teaser">
        <div class="title">Projects</div>
        <p class="excerpt">Some Yorko's (pet)-projects featured</p>
      </a>
    </li><li>
      <a href="http://localhost:4000/cv">
        <img src="http://localhost:4000/images/navigation/thumbnail-cv.png" alt="teaser" class="teaser">
        <div class="title">CV</div>
        <p class="excerpt">Yorko's work experience and education</p>
      </a>
    </li><li>
      <a href="http://localhost:4000/about">
        <img src="http://localhost:4000/images/navigation/thumbnail-about.png" alt="teaser" class="teaser">
        <div class="title">About</div>
        <p class="excerpt">Who the heck is Yorko?</p>
      </a>
    </li><li>
      <a href="http://localhost:4000/contacts">
        <img src="http://localhost:4000/images/navigation/thumbnail-contacts.png" alt="teaser" class="teaser">
        <div class="title">Contacts</div>
        <p class="excerpt">How to reach out to Yorko</p>
      </a>
    </li>
  </ul>
</nav>
<button type="button" id="js-menu-trigger" class="sliding-menu-button lines-button x2" role="button" aria-label="Toggle Navigation">
  <span class="nav-lines"></span>
</button>

<div id="js-menu-screen" class="menu-screen"></div>


    <div id="page-wrapper">
      <div id="main" role="main">
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
		
		
		<div class="page-title">
			<h1>ChatGPT is fairly good at coreference resolution and coding assignments</h1>
		</div>
		<div class="inner-wrap">
			<div id="content" class="page-content" itemprop="articleBody">
				<p>​
Here I’m trying to discover ChatGPT’s weaknesses and test its ability to resolve coreferences in natural text and crack <a href="https://mlcourse.ai]">mlcourse.ai</a> assignments. Naturally, I could not resist playing with the new OpanAI chatbot <a href="https://openai.com/blog/chatgpt/">chatGPT</a> with the goal of spotting some of its weaknesses. Quite a few have already been pointed out, e.g. Sergey Ivanov even <a href="https://tinyurl.com/3vfje8sx">measured</a> chatGPT’s IQ.</p>

<div style="text-align:center"><img src="/images/20221204-chatgpt3-coref-resolution/chatgpt_iq_test.jpeg" width="500px" /></div>
<p><em>ChatGPT’s IQ test. <a href="https://tinyurl.com/3vfje8sx">Source</a>.</em></p>

<h2 id="chatgpt-and-a-kaggle-pronoun-resolution-task">chatGPT and a Kaggle pronoun resolution task</h2>

<p>I decided to test the chatbot in the coreference resolution task. This was the first Kaggle competition where people started using BERT-like models. I clearly remember how we fiddled with all sorts of old school models, until Matei Iinota (a would-be first author of our <a href="https://arxiv.org/abs/1906.01161">research paper</a> based on the competiiton) smashed the leaderboard by posting <a href="https://www.kaggle.com/code/mateiionita/taming-the-bert-a-baseline">a BERT-based solution</a> (no HuggingFace back then, the solution was based on Google’s BERT <a href="https://github.com/google-research/bert">source code</a> in TensorFlow).</p>

<div style="text-align:center"><img src="/images/20221204-chatgpt3-coref-resolution/coref_resolution.png" width="500px" /></div>
<p><em>Part of the Gendered Pronoun Resolution competition description. <a href="https://www.kaggle.com/competitions/gendered-pronoun-resolution/overview">Source</a>.</em></p>

<p>Let’s explain what the task is about. A simple example of coreference resolution: given two sentences</p>
<blockquote>
  <p>“Lucy went to the gym. Her dog stayed at home”</p>
</blockquote>

<p>try to figure out that the pronoun “her” refers to Lucy.</p>

<p>A similar example, but a bit more more complicated example:</p>
<blockquote>
  <p>“Lucy went to the Maria. Her dog stayed at home”.</p>
</blockquote>

<p>Now we need to infer that “her” refers to Lucy, not Maria.</p>

<p>In the competition, the examples were more complicated, where even a human needs to burn some brain fuel to resolve coreference.</p>

<blockquote>
  <p>Zoe Telford – played the police officer girlfriend of Simon, Maggie. Dumped by Simon in the final episode of series 1, after he slept with Jenny, and is not seen again. Phoebe Thomas played Cheryl Cassidy, Pauline’s friend and also a year 11 pupil in Simon’s class. Dumped <strong>her</strong> boyfriend following Simon’s advice after he wouldn’t have sex with her but later realised this was due to him catching crabs off her friend Pauline.”</p>
</blockquote>

<p>Try to read this passage and infer who the bolded pronoun “her” refers to. Not so easy, is it? However, the task is simplified: for each example, they provide two options, in this example: <em>Cheryl Cassidy</em> (option A) or <em>Pauline</em> (option B). A pronoun can also refer to none of A or B. In this case, the answer is <em>Cheryl Cassidy</em>.</p>

<p>In the competition, we needed to perform coreference resolution only for pronouns, and thus the task type was pronoun resolution.</p>

<div style="text-align:center"><img src="/images/20221204-chatgpt3-coref-resolution/gap_dev_set.png" width="600px" /></div>
<p><em>First 5 rows of the <a href="https://www.kaggle.com/competitions/gendered-pronoun-resolution/overview">GAP development set</a>. A Wikipedia text excerpt is given, with a pronoun <code class="language-plaintext highlighter-rouge">Pronoun</code> and its char offset, named entities <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">B</code> with their offsets, and binary flags <code class="language-plaintext highlighter-rouge">A-coref</code> and <code class="language-plaintext highlighter-rouge">B-coref</code> - whether the pronoun referes to A, B, or neither of them.</em></p>

<p>In such a problem setup, vanilla BERT without fine-tuning hits 76% accuracy. later in the competition, we saw that an ensemble of fine-tuned BERTs pushes this closer to 98%.</p>

<p>I built up some patience and fed a 100 examples from this Kaggle problem into chatGPT3 uin a format</p>
<blockquote>
  <p>“{Text}. Does ‘{Pronoun}’ at an offset of {offset} chars refer to {A} or {B}?”.</p>
</blockquote>

<p>The result? Far from a fine-tuned BERT, but chatGPT hit 76% accuracy, same as BERT that was not fine-tuned for the task (and 69% micro F1 score, comparable to un-fine-tuned BERT, just a bit less).</p>

<p>I was pleased to seethat chatGPT3 tried to explain why it believes that the pronoun refers to one person, and not to another.</p>

<div style="text-align:center"><img src="/images/20221204-chatgpt3-coref-resolution/gpt3_explaining_its_inference.png" width="700px" /></div>

<p>In such a zero-shot problem statement, that’s a fairly good no-code solution. isn’t it? At least when compared to vanilla BERT (which we treat as something given now in 2022) which also required the whole Kaggle community to tinker for some couple of weeks back then in 2018.</p>

<p>It will be interesting to check chatGPT3 with <a href="https://en.wikipedia.org/wiki/Winograd_schema_challenge">Winograd schemes</a>, simple examples in which the reader (either a human or an algorithm) needs both knowledge and commonsense reasoning to perform anaphora resolution. Example:</p>
<blockquote>
  <p>“The city councilmen refused the demonstrators a permit because they [feared/advocated] violence”.</p>
</blockquote>

<p>Depending on the choice of “feared” or “advocated”, the pronoun “they” refers to either “councilmen” or “demonstrators”.</p>

<h2 id="chatgpt-cracking-mlcourseai-assignments">chatGPT cracking mlcourse.ai assignments</h2>

<p>I also found that chatGPT3 scores 7/10 in the <a href="https://mlcourse.ai/book/topic01/assignment01_pandas_uci_adult.html">1st mlcourse.ai demo assignment</a>. It generates valid code with comments, although sometimes things can be done much simpler. It struggles though with generalization, e.g. answering “are there more men than women?” once the numbers are there.</p>

<div style="text-align:center"><img src="/images/20221204-chatgpt3-coref-resolution/chatgpt_mlcourse_a1_q1.png" width="700px" /></div>

<p>For demo assignment 8, chatGPT3 also created a perfect implementation of the Stochastic Gradient Regressor which works, and the model explained how to use it.</p>

<div style="text-align:center"><img src="/images/20221204-chatgpt3-coref-resolution/chatgpt_mlcourse_a1_q8.png" width="700px" /></div>

<h2 id="conclusion">Conclusion</h2>

<p>I’ll go on fiddling with chatGPT but the intermediate conclusion is quite philosophical. In the past, when I heard “AI”, I’d always stress that we, ML-specialists, are dealing with machine learning, and not “artificial intelligence”. “AI for advanced If-Else”, “matrix multiplication” will conquer the world, and all sorts of similar jokes. Now I’ll be more humble with such reservations, we can already see how machine learning leads to actual (weak) artificial intelligence. CAt some point they’ll model commonsense reasoning, tie together language, voice, photo- and video models, add knowledge graphs, databases and Internet access plus some technologies that we are not aware of yet - and wow, it’s hard to imagine what the outcome will be.</p>


				<hr />
				<footer class="page-footer">
					

<div class="author-image">
	<img src="http://localhost:4000/images/bio-photo.jpg" alt="Yury Kashnitsky">
</div><!-- ./author-image -->
<div class="author-content">
	<h3 class="author-name" >Written by <a href="https://yorko.github.io" itemprop="author">Yury Kashnitsky</a></h3>
	<p class="author-bio">Yury Kashnitsky is a Principal Machine Learning Scientist, NLP practitioner, Ph.D. in applied math, and leader of the open Machine Learning course mlcourse.ai</p>
</div><!-- ./author-content -->
					<div class="inline-btn">
	<a class="btn-social twitter" href="https://twitter.com/intent/tweet?text=ChatGPT%20is%20fairly%20good%20at%20coreference%20resolution%20and%20coding%20assignments&amp;url=http://localhost:4000/2022/chatgpt3-coref-resolution/&amp;via=ykashnitsky" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i> Share on Twitter</a>
	<a class="btn-social facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2022/chatgpt3-coref-resolution/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i> Share on Facebook</a>
	<a class="btn-social linkedin"  href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2022/chatgpt3-coref-resolution/&title=&summary=&source=webjeda" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i> Share on LinkedIn</a>
</div><!-- /.share-this -->

					<div class="page-meta">
	<p>Updated <time datetime="2022-12-04T00:00:00Z" itemprop="datePublished">December 04, 2022</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<aside>
					<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'yorko-github-io';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- ./wrap -->
</div><!-- /#main -->


      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
			<li><a href="http://localhost:4000/" >BLOG</a></li>
		
      
			<li><a href="http://localhost:4000/contacts" >CONTACTS</a></li>
		
      
			<li><a href="https://www.linkedin.com/in/kashnitskiy" target="_blank">LINKEDIN</a></li>
		
      
			<li><a href="https://www.youtube.com/channel/UCgGADKKGalfwSNbpSyM5ryg" target="_blank">YOUTUBE</a></li>
		
      
			<li><a href="https://twitter.com/ykashnitsky" target="_blank">TWITTER</a></li>
		
      
			<li><a href="https://www.kaggle.com/kashnitsky" target="_blank">KAGGLE</a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">&#169; 2022 <a href="http://localhost:4000">Yury Kashnitsky</a> (yury.kashnitsky@gmail.com). Powered by <a href="http://jekyllrb.com">Jekyll</a> + <a href="https://mmistakes.github.io/skinny-bones-jekyll/">Skinny Bones</a>.</p>
</footer>

    </div>

    <script src="http://localhost:4000/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="http://localhost:4000/js/main.js"></script>

  </body>

</html>
